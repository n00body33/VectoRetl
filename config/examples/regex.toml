# Regex Configuration Example
# ------------------------------------------------------------------------------
# A simple example that ingests Apache2 logs, parses them with Regex, and
# prints them to STDOUT for inspection.

data_dir = "/var/lib/vector"

# Ingests Apache 2 log data by tailing one or more log files
# Example: 194.221.90.140 - - [22/06/2019:11:55:14 -0400] "PUT /integrate" 100 2213
# Docs: https://docs.vectorproject.io/usage/configuration/sources/file
[sources.apache_logs]
  type         = "file"
  include      = ["/var/log/apache2/*.log"]
  ignore_older = 86400 # 1 day

# Structure and parse the data
# Docs: https://docs.vectorproject.io/usage/configuration/transforms/regex_parser
[transforms.apache_parser]
  inputs       = ["apache_logs"]
  type         = "regex_parser"
  regex        = '^(?P<host>[w.]+) - (?P<user>[w]+) (?P<bytes_in>[d]+) [(?P<timestamp>.*)] "(?P<method>[w]+) (?P<path>.*)" (?P<status>[d]+) (?P<bytes_out>[d]+)$'

# Print the data to STDOUT for inspection
# Docs: https://docs.vectorproject.io/usage/configuration/sinks/console
[sinks.out]
  inputs       = ["apache_parser"] # don't sample
  type         = "console"