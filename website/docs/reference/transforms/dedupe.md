---
component_title: "Dedupe events"
description: "The Vector `dedupe` transform accepts and outputs `log` events allowing you to prevent duplicate Events from being outputted by using an LRU cache."
event_types: ["log"]
issues_url: https://github.com/timberio/vector/issues?q=is%3Aopen+is%3Aissue+label%3A%22transform%3A+dedupe%22
min_version: null
service_name: "Dedupe events"
sidebar_label: "dedupe|[\"log\"]"
source_url: https://github.com/timberio/vector/tree/master/src/transforms/dedupe.rs
status: "prod-ready"
title: "Dedupe events Transform"
---

The Vector `dedupe` transform accepts and outputs [`log`][docs.data-model.log] events allowing you to prevent duplicate Events from being outputted by using an LRU cache.

<!--
     THIS FILE IS AUTOGENERATED!

     To make changes please edit the template located at:

     website/docs/reference/transforms/dedupe.md.erb
-->

## Configuration

import CodeHeader from '@site/src/components/CodeHeader';

<CodeHeader fileName="vector.toml" learnMoreUrl="/docs/setup/configuration/"/ >

```toml
[transforms.my_transform_id]
  # REQUIRED - General
  type = "dedupe" # must be: "dedupe"
  inputs = ["my-source-id"] # example

  # REQUIRED - Fields
  [transforms.my_transform_id.fields]
    ignore = ["field1", "field2"] # example, no default
    match = ["timestamp"] # default
```

## Options

import Fields from '@site/src/components/Fields';

import Field from '@site/src/components/Field';

<Fields filters={true}>


<Field
  common={false}
  defaultValue={null}
  enumValues={null}
  examples={[]}
  groups={[]}
  name={"cache"}
  path={null}
  relevantWhen={null}
  required={false}
  templateable={false}
  type={"table"}
  unit={null}
  >

### cache

Options controlling how we cache recent Events for future duplicate checking.

<Fields filters={false}>


<Field
  common={true}
  defaultValue={5000}
  enumValues={null}
  examples={[5000]}
  groups={[]}
  name={"num_entries"}
  path={"cache"}
  relevantWhen={null}
  required={false}
  templateable={false}
  type={"int"}
  unit={null}
  >

#### num_entries

The number of recent Events to cache and compare new incoming Events against.


</Field>


</Fields>

</Field>


<Field
  common={true}
  defaultValue={null}
  enumValues={null}
  examples={[]}
  groups={[]}
  name={"fields"}
  path={null}
  relevantWhen={null}
  required={true}
  templateable={false}
  type={"table"}
  unit={null}
  >

### fields

Options controlling what fields to match against

<Fields filters={false}>


<Field
  common={true}
  defaultValue={null}
  enumValues={null}
  examples={[["field1","field2"]]}
  groups={[]}
  name={"ignore"}
  path={"fields"}
  relevantWhen={null}
  required={false}
  templateable={false}
  type={"[string]"}
  unit={null}
  >

#### ignore

The field names to ignore when deciding if an Event is a duplicate. Incompatible with the "fields.match" option.


</Field>


<Field
  common={true}
  defaultValue={["timestamp"]}
  enumValues={null}
  examples={[["field1","field2"]]}
  groups={[]}
  name={"match"}
  path={"fields"}
  relevantWhen={null}
  required={false}
  templateable={false}
  type={"[string]"}
  unit={null}
  >

#### match

The field names considered when deciding if an Event is a duplicate. Incompatible with the "fields.ignore" option.


</Field>


</Fields>

</Field>


</Fields>

## How It Works

### Cache Behavior

This transform is backed by an LRU cache of size `cache.num_entries`.
That means that this transform will cache information in memory for the last
`cache.num_entries` Events that it has processed.  Entries will be removed from
the cache in the order they were inserted.  If an Event is received that is
considered a duplicate of an Event already in the cache that will put that event
back to the head of the cache and reset its place in line, making it once again
last entry in line to be evicted.

### Environment Variables

Environment variables are supported through all of Vector's configuration.
Simply add `${MY_ENV_VAR}` in your Vector configuration file and the variable
will be replaced before being evaluated.

You can learn more in the [Environment Variables][docs.configuration#environment-variables]
section.

### Memory Usage Details

Each entry in the cache corresponds to an incoming Event and contains a copy of
the 'value' data for all fields in the Event being considered for matching.
When using `fields.match` this will be the list of fields specified in that
config option. When using `fields.ignore` that will include all fields present
in the incoming event *except* those specified in `fields.ignore`. Each entry
also uses a single byte per field to store the type information of that field.
When using `fields.ignore` each cache entry additionally stores a copy of each
field name being considered for matching.  When using `fields.match` storing
the field names is not necessary.

### Memory Utilization Estimation

If you want to estimate the memory requirements of this transform
for your dataset, you can do so with these formulas:

When using `fields.match`:
Sum(the average size of the *data* (but not including the field name) for each field in `fields.match`) * `cache.num_entries`

When using `fields.ignore`:
(Sum(the average size of each incoming Event) - (the average size of the field name *and* value for each field in `fields.ignore`)) * `cache.num_entries`


[docs.configuration#environment-variables]: /docs/setup/configuration/#environment-variables
[docs.data-model.log]: /docs/about/data-model/log/
